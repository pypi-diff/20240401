# Comparing `tmp/grain_nightly-0.0.6-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.zip` & `tmp/grain_nightly-0.0.7-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.zip`

## zipinfo {}

```diff
@@ -1,94 +1,94 @@
-Zip file size: 385891 bytes, number of entries: 92
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain_nightly.libs/
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain_nightly-0.0.6.dist-info/
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/_src/
--rw-r--r--  2.0 unx      928 b- defN 24-Feb-08 23:04 grain/core.py
--rw-r--r--  2.0 unx     1228 b- defN 24-Feb-08 23:04 grain/python_experimental.py
--rw-r--r--  2.0 unx     2120 b- defN 24-Feb-08 23:04 grain/python.py
--rw-r--r--  2.0 unx     2074 b- defN 24-Feb-08 23:04 grain/python_lazy_dataset.py
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/_src/core/
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/_src/python/
--rw-r--r--  2.0 unx     2391 b- defN 24-Feb-08 23:04 grain/_src/core/tree_test.py
--rw-r--r--  2.0 unx     3156 b- defN 24-Feb-08 23:04 grain/_src/core/parallel_test.py
--rw-r--r--  2.0 unx     1245 b- defN 24-Feb-08 23:04 grain/_src/core/tree_jax_test.py
--rw-r--r--  2.0 unx     3618 b- defN 24-Feb-08 23:04 grain/_src/core/config.py
--rw-r--r--  2.0 unx     3767 b- defN 24-Feb-08 23:04 grain/_src/core/transforms.py
--rw-r--r--  2.0 unx      685 b- defN 24-Feb-08 23:04 grain/_src/core/usage_logging.py
--rw-r--r--  2.0 unx     1939 b- defN 24-Feb-08 23:04 grain/_src/core/tree.py
--rw-r--r--  2.0 unx     1277 b- defN 24-Feb-08 23:04 grain/_src/core/sharding_test.py
--rw-r--r--  2.0 unx      109 b- defN 24-Feb-08 23:04 grain/_src/core/exceptions.py
--rw-r--r--  2.0 unx     2310 b- defN 24-Feb-08 23:04 grain/_src/core/parallel.py
--rw-r--r--  2.0 unx     1633 b- defN 24-Feb-08 23:04 grain/_src/core/constants.py
--rw-r--r--  2.0 unx     3561 b- defN 24-Feb-08 23:04 grain/_src/core/sharding.py
--rw-r--r--  2.0 unx     5380 b- defN 24-Feb-08 23:04 grain/_src/core/grain_random.py
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/_src/python/experimental/
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/_src/python/lazy_dataset/
--rw-r--r--  2.0 unx     5514 b- defN 24-Feb-08 23:04 grain/_src/python/samplers.py
--rw-r--r--  2.0 unx    11244 b- defN 24-Feb-08 23:04 grain/_src/python/grain_pool_test.py
--rw-r--r--  2.0 unx    23300 b- defN 24-Feb-08 23:04 grain/_src/python/grain_pool.py
--rw-r--r--  2.0 unx     1288 b- defN 24-Feb-08 23:04 grain/_src/python/record_test.py
--rw-r--r--  2.0 unx     5010 b- defN 24-Feb-08 23:04 grain/_src/python/data_sources_test.py
--rw-r--r--  2.0 unx     7432 b- defN 24-Feb-08 23:04 grain/_src/python/operations.py
--rw-r--r--  2.0 unx     2049 b- defN 24-Feb-08 23:04 grain/_src/python/load_test.py
--rw-r--r--  2.0 unx     3580 b- defN 24-Feb-08 23:04 grain/_src/python/multiprocessing_common_test.py
--rw-r--r--  2.0 unx     5139 b- defN 24-Feb-08 23:04 grain/_src/python/shared_memory_array.py
--rw-r--r--  2.0 unx     2320 b- defN 24-Feb-08 23:04 grain/_src/python/load.py
--rw-r--r--  2.0 unx      552 b- defN 24-Feb-08 23:04 grain/_src/python/grain_logging.py
--rw-r--r--  2.0 unx     2442 b- defN 24-Feb-08 23:04 grain/_src/python/options.py
--rw-r--r--  2.0 unx     1746 b- defN 24-Feb-08 23:04 grain/_src/python/grain_logging_test.py
--rw-r--r--  2.0 unx     5309 b- defN 24-Feb-08 23:04 grain/_src/python/data_sources.py
--rw-r--r--  2.0 unx    21011 b- defN 24-Feb-08 23:04 grain/_src/python/data_loader_test.py
--rw-r--r--  2.0 unx    19035 b- defN 24-Feb-08 23:04 grain/_src/python/data_loader.py
--rw-r--r--  2.0 unx    23219 b- defN 24-Feb-08 23:04 grain/_src/python/samplers_test.py
--rw-r--r--  2.0 unx     3174 b- defN 24-Feb-08 23:04 grain/_src/python/checkpoint_handlers.py
--rw-r--r--  2.0 unx    13128 b- defN 24-Feb-08 23:04 grain/_src/python/operations_test.py
--rw-r--r--  2.0 unx     2434 b- defN 24-Feb-08 23:04 grain/_src/python/multiprocessing_common.py
--rw-r--r--  2.0 unx     1741 b- defN 24-Feb-08 23:04 grain/_src/python/record.py
--rw-r--r--  2.0 unx     3007 b- defN 24-Feb-08 23:04 grain/_src/python/shared_memory_array_test.py
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/_src/python/experimental/example_packing/
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/_src/python/experimental/continual_sequence_sampler/
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/_src/python/experimental/index_shuffle/
--rw-r--r--  2.0 unx    13841 b- defN 24-Feb-08 23:04 grain/_src/python/experimental/example_packing/packing_test.py
--rw-r--r--  2.0 unx     8133 b- defN 24-Feb-08 23:04 grain/_src/python/experimental/example_packing/packing.py
--rw-r--r--  2.0 unx    17255 b- defN 24-Feb-08 23:04 grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler_test.py
--rw-r--r--  2.0 unx    16400 b- defN 24-Feb-08 23:04 grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler.py
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/_src/python/experimental/index_shuffle/python/
--rwxr-xr-x  2.0 unx   191504 b- defN 24-Feb-08 23:04 grain/_src/python/experimental/index_shuffle/libindex_shuffle.so
--rwxr-xr-x  2.0 unx   871568 b- defN 24-Feb-08 23:04 grain/_src/python/experimental/index_shuffle/python/index_shuffle_module.so
--rw-r--r--  2.0 unx     1621 b- defN 24-Feb-08 23:04 grain/_src/python/experimental/index_shuffle/python/index_shuffle_python_test.py
--rw-r--r--  2.0 unx     1586 b- defN 24-Feb-08 23:04 grain/_src/python/experimental/index_shuffle/python/index_shuffle_test.py
--rw-r--r--  2.0 unx     2490 b- defN 24-Feb-08 23:04 grain/_src/python/experimental/index_shuffle/python/index_shuffle_python.py
-drwxr-xr-x  2.0 unx        0 b- stor 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/
--rw-r--r--  2.0 unx     7873 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/grain_pool_v2_test.py
--rw-r--r--  2.0 unx     2742 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/data_sources_test.py
--rw-r--r--  2.0 unx    11912 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/grain_pool_v2.py
--rw-r--r--  2.0 unx     1603 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/data_sources.py
--rw-r--r--  2.0 unx     9763 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/lazy_dataset_test.py
--rw-r--r--  2.0 unx    18734 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/lazy_dataset.py
--rw-r--r--  2.0 unx     1565 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/ragged_batch.py
--rw-r--r--  2.0 unx     3294 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/filter.py
--rw-r--r--  2.0 unx    12276 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/packing_test.py
--rw-r--r--  2.0 unx     1701 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/repeat.py
--rw-r--r--  2.0 unx     1420 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/repeat_test.py
--rw-r--r--  2.0 unx     9660 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/mix.py
--rw-r--r--  2.0 unx    10244 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/packing.py
--rw-r--r--  2.0 unx     3003 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/batch_test.py
--rw-r--r--  2.0 unx     2618 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/slice_test.py
--rw-r--r--  2.0 unx     2963 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/shuffle.py
--rw-r--r--  2.0 unx     2018 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/flatmap.py
--rw-r--r--  2.0 unx     3644 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/shuffle_test.py
--rw-r--r--  2.0 unx     1591 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/slice.py
--rw-r--r--  2.0 unx    15586 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/mix_test.py
--rw-r--r--  2.0 unx     3996 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/ragged_batch_test.py
--rw-r--r--  2.0 unx     4127 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/filter_test.py
--rw-r--r--  2.0 unx     6366 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/map_test.py
--rw-r--r--  2.0 unx     3996 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/batch.py
--rw-r--r--  2.0 unx     4180 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/flatmap_test.py
--rw-r--r--  2.0 unx     7239 b- defN 24-Feb-08 23:04 grain/_src/python/lazy_dataset/transformations/map.py
--rw-rw-r--  2.0 unx     8086 b- defN 24-Feb-08 23:04 grain_nightly-0.0.6.dist-info/RECORD
--rw-r--r--  2.0 unx    13899 b- defN 24-Feb-08 23:04 grain_nightly-0.0.6.dist-info/METADATA
--rw-r--r--  2.0 unx      148 b- defN 24-Feb-08 23:04 grain_nightly-0.0.6.dist-info/WHEEL
--rw-r--r--  2.0 unx    11357 b- defN 24-Feb-08 23:04 grain_nightly-0.0.6.dist-info/LICENSE
--rw-r--r--  2.0 unx        6 b- defN 24-Feb-08 23:04 grain_nightly-0.0.6.dist-info/top_level.txt
-92 files, 1513103 bytes uncompressed, 370963 bytes compressed:  75.5%
+Zip file size: 383369 bytes, number of entries: 92
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain_nightly-0.0.7.dist-info/
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain_nightly.libs/
+-rw-r--r--  2.0 unx      148 b- defN 24-Apr-01 16:50 grain_nightly-0.0.7.dist-info/WHEEL
+-rw-r--r--  2.0 unx        6 b- defN 24-Apr-01 16:50 grain_nightly-0.0.7.dist-info/top_level.txt
+-rw-r--r--  2.0 unx    11357 b- defN 24-Apr-01 16:50 grain_nightly-0.0.7.dist-info/LICENSE
+-rw-r--r--  2.0 unx    13899 b- defN 24-Apr-01 16:50 grain_nightly-0.0.7.dist-info/METADATA
+-rw-rw-r--  2.0 unx     8082 b- defN 24-Apr-01 16:50 grain_nightly-0.0.7.dist-info/RECORD
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/_src/
+-rw-r--r--  2.0 unx     2104 b- defN 24-Apr-01 16:50 grain/python_lazy_dataset.py
+-rw-r--r--  2.0 unx      928 b- defN 24-Apr-01 16:50 grain/core.py
+-rw-r--r--  2.0 unx     2222 b- defN 24-Apr-01 16:50 grain/python.py
+-rw-r--r--  2.0 unx     1265 b- defN 24-Apr-01 16:50 grain/python_experimental.py
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/_src/core/
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/_src/python/
+-rw-r--r--  2.0 unx     1939 b- defN 24-Apr-01 16:50 grain/_src/core/tree.py
+-rw-r--r--  2.0 unx     1245 b- defN 24-Apr-01 16:50 grain/_src/core/tree_jax_test.py
+-rw-r--r--  2.0 unx      685 b- defN 24-Apr-01 16:50 grain/_src/core/usage_logging.py
+-rw-r--r--  2.0 unx     3957 b- defN 24-Apr-01 16:50 grain/_src/core/config.py
+-rw-r--r--  2.0 unx     3767 b- defN 24-Apr-01 16:50 grain/_src/core/transforms.py
+-rw-r--r--  2.0 unx     5380 b- defN 24-Apr-01 16:50 grain/_src/core/grain_random.py
+-rw-r--r--  2.0 unx     2391 b- defN 24-Apr-01 16:50 grain/_src/core/tree_test.py
+-rw-r--r--  2.0 unx     1277 b- defN 24-Apr-01 16:50 grain/_src/core/sharding_test.py
+-rw-r--r--  2.0 unx     3156 b- defN 24-Apr-01 16:50 grain/_src/core/parallel_test.py
+-rw-r--r--  2.0 unx      109 b- defN 24-Apr-01 16:50 grain/_src/core/exceptions.py
+-rw-r--r--  2.0 unx     3680 b- defN 24-Apr-01 16:50 grain/_src/core/sharding.py
+-rw-r--r--  2.0 unx     1633 b- defN 24-Apr-01 16:50 grain/_src/core/constants.py
+-rw-r--r--  2.0 unx     2310 b- defN 24-Apr-01 16:50 grain/_src/core/parallel.py
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/_src/python/experimental/
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/_src/python/lazy_dataset/
+-rw-r--r--  2.0 unx    23219 b- defN 24-Apr-01 16:50 grain/_src/python/samplers_test.py
+-rw-r--r--  2.0 unx     1288 b- defN 24-Apr-01 16:50 grain/_src/python/record_test.py
+-rw-r--r--  2.0 unx     2434 b- defN 24-Apr-01 16:50 grain/_src/python/multiprocessing_common.py
+-rw-r--r--  2.0 unx    21011 b- defN 24-Apr-01 16:50 grain/_src/python/data_loader_test.py
+-rw-r--r--  2.0 unx     3007 b- defN 24-Apr-01 16:50 grain/_src/python/shared_memory_array_test.py
+-rw-r--r--  2.0 unx     5514 b- defN 24-Apr-01 16:50 grain/_src/python/samplers.py
+-rw-r--r--  2.0 unx     2442 b- defN 24-Apr-01 16:50 grain/_src/python/options.py
+-rw-r--r--  2.0 unx     3580 b- defN 24-Apr-01 16:50 grain/_src/python/multiprocessing_common_test.py
+-rw-r--r--  2.0 unx    11244 b- defN 24-Apr-01 16:50 grain/_src/python/grain_pool_test.py
+-rw-r--r--  2.0 unx     7432 b- defN 24-Apr-01 16:50 grain/_src/python/operations.py
+-rw-r--r--  2.0 unx     3174 b- defN 24-Apr-01 16:50 grain/_src/python/checkpoint_handlers.py
+-rw-r--r--  2.0 unx     1741 b- defN 24-Apr-01 16:50 grain/_src/python/record.py
+-rw-r--r--  2.0 unx      552 b- defN 24-Apr-01 16:50 grain/_src/python/grain_logging.py
+-rw-r--r--  2.0 unx     5010 b- defN 24-Apr-01 16:50 grain/_src/python/data_sources_test.py
+-rw-r--r--  2.0 unx    23300 b- defN 24-Apr-01 16:50 grain/_src/python/grain_pool.py
+-rw-r--r--  2.0 unx     5139 b- defN 24-Apr-01 16:50 grain/_src/python/shared_memory_array.py
+-rw-r--r--  2.0 unx     5309 b- defN 24-Apr-01 16:50 grain/_src/python/data_sources.py
+-rw-r--r--  2.0 unx     1746 b- defN 24-Apr-01 16:50 grain/_src/python/grain_logging_test.py
+-rw-r--r--  2.0 unx    19035 b- defN 24-Apr-01 16:50 grain/_src/python/data_loader.py
+-rw-r--r--  2.0 unx    13128 b- defN 24-Apr-01 16:50 grain/_src/python/operations_test.py
+-rw-r--r--  2.0 unx     2320 b- defN 24-Apr-01 16:50 grain/_src/python/load.py
+-rw-r--r--  2.0 unx     2049 b- defN 24-Apr-01 16:50 grain/_src/python/load_test.py
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/_src/python/experimental/index_shuffle/
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/_src/python/experimental/example_packing/
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/_src/python/experimental/continual_sequence_sampler/
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/_src/python/experimental/index_shuffle/python/
+-rwxr-xr-x  2.0 unx   191504 b- defN 24-Apr-01 16:50 grain/_src/python/experimental/index_shuffle/libindex_shuffle.so
+-rwxr-xr-x  2.0 unx   871568 b- defN 24-Apr-01 16:50 grain/_src/python/experimental/index_shuffle/python/index_shuffle_module.so
+-rw-r--r--  2.0 unx     2490 b- defN 24-Apr-01 16:50 grain/_src/python/experimental/index_shuffle/python/index_shuffle_python.py
+-rw-r--r--  2.0 unx     1586 b- defN 24-Apr-01 16:50 grain/_src/python/experimental/index_shuffle/python/index_shuffle_test.py
+-rw-r--r--  2.0 unx     1621 b- defN 24-Apr-01 16:50 grain/_src/python/experimental/index_shuffle/python/index_shuffle_python_test.py
+-rw-r--r--  2.0 unx    13841 b- defN 24-Apr-01 16:50 grain/_src/python/experimental/example_packing/packing_test.py
+-rw-r--r--  2.0 unx     8133 b- defN 24-Apr-01 16:50 grain/_src/python/experimental/example_packing/packing.py
+-rw-r--r--  2.0 unx    16400 b- defN 24-Apr-01 16:50 grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler.py
+-rw-r--r--  2.0 unx    17255 b- defN 24-Apr-01 16:50 grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler_test.py
+drwxr-xr-x  2.0 unx        0 b- stor 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/
+-rw-r--r--  2.0 unx     9763 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/lazy_dataset_test.py
+-rw-r--r--  2.0 unx    18734 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/lazy_dataset.py
+-rw-r--r--  2.0 unx     4310 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/data_loader_test.py
+-rw-r--r--  2.0 unx     2742 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/data_sources_test.py
+-rw-r--r--  2.0 unx     1603 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/data_sources.py
+-rw-r--r--  2.0 unx     2665 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/data_loader.py
+-rw-r--r--  2.0 unx     1591 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/slice.py
+-rw-r--r--  2.0 unx     2018 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/flatmap.py
+-rw-r--r--  2.0 unx     1420 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/repeat_test.py
+-rw-r--r--  2.0 unx     7300 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/map.py
+-rw-r--r--  2.0 unx     3644 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/shuffle_test.py
+-rw-r--r--  2.0 unx     1701 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/repeat.py
+-rw-r--r--  2.0 unx     2963 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/shuffle.py
+-rw-r--r--  2.0 unx     3996 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/ragged_batch_test.py
+-rw-r--r--  2.0 unx     3003 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/batch_test.py
+-rw-r--r--  2.0 unx    11774 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/mix.py
+-rw-r--r--  2.0 unx    12276 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/packing_test.py
+-rw-r--r--  2.0 unx     1565 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/ragged_batch.py
+-rw-r--r--  2.0 unx     3294 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/filter.py
+-rw-r--r--  2.0 unx     6743 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/map_test.py
+-rw-r--r--  2.0 unx     4127 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/filter_test.py
+-rw-r--r--  2.0 unx     4180 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/flatmap_test.py
+-rw-r--r--  2.0 unx     3996 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/batch.py
+-rw-r--r--  2.0 unx    10244 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/packing.py
+-rw-r--r--  2.0 unx    17586 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/mix_test.py
+-rw-r--r--  2.0 unx     2618 b- defN 24-Apr-01 16:50 grain/_src/python/lazy_dataset/transformations/slice_test.py
+92 files, 1505468 bytes uncompressed, 368449 bytes compressed:  75.5%
```

## zipnote {}

```diff
@@ -1,277 +1,277 @@
+Filename: grain_nightly-0.0.7.dist-info/
+Comment: 
+
 Filename: grain/
 Comment: 
 
 Filename: grain_nightly.libs/
 Comment: 
 
-Filename: grain_nightly-0.0.6.dist-info/
+Filename: grain_nightly-0.0.7.dist-info/WHEEL
+Comment: 
+
+Filename: grain_nightly-0.0.7.dist-info/top_level.txt
+Comment: 
+
+Filename: grain_nightly-0.0.7.dist-info/LICENSE
+Comment: 
+
+Filename: grain_nightly-0.0.7.dist-info/METADATA
+Comment: 
+
+Filename: grain_nightly-0.0.7.dist-info/RECORD
 Comment: 
 
 Filename: grain/_src/
 Comment: 
 
-Filename: grain/core.py
+Filename: grain/python_lazy_dataset.py
 Comment: 
 
-Filename: grain/python_experimental.py
+Filename: grain/core.py
 Comment: 
 
 Filename: grain/python.py
 Comment: 
 
-Filename: grain/python_lazy_dataset.py
+Filename: grain/python_experimental.py
 Comment: 
 
 Filename: grain/_src/core/
 Comment: 
 
 Filename: grain/_src/python/
 Comment: 
 
-Filename: grain/_src/core/tree_test.py
+Filename: grain/_src/core/tree.py
 Comment: 
 
-Filename: grain/_src/core/parallel_test.py
+Filename: grain/_src/core/tree_jax_test.py
 Comment: 
 
-Filename: grain/_src/core/tree_jax_test.py
+Filename: grain/_src/core/usage_logging.py
 Comment: 
 
 Filename: grain/_src/core/config.py
 Comment: 
 
 Filename: grain/_src/core/transforms.py
 Comment: 
 
-Filename: grain/_src/core/usage_logging.py
+Filename: grain/_src/core/grain_random.py
 Comment: 
 
-Filename: grain/_src/core/tree.py
+Filename: grain/_src/core/tree_test.py
 Comment: 
 
 Filename: grain/_src/core/sharding_test.py
 Comment: 
 
-Filename: grain/_src/core/exceptions.py
+Filename: grain/_src/core/parallel_test.py
 Comment: 
 
-Filename: grain/_src/core/parallel.py
+Filename: grain/_src/core/exceptions.py
 Comment: 
 
-Filename: grain/_src/core/constants.py
+Filename: grain/_src/core/sharding.py
 Comment: 
 
-Filename: grain/_src/core/sharding.py
+Filename: grain/_src/core/constants.py
 Comment: 
 
-Filename: grain/_src/core/grain_random.py
+Filename: grain/_src/core/parallel.py
 Comment: 
 
 Filename: grain/_src/python/experimental/
 Comment: 
 
 Filename: grain/_src/python/lazy_dataset/
 Comment: 
 
-Filename: grain/_src/python/samplers.py
-Comment: 
-
-Filename: grain/_src/python/grain_pool_test.py
-Comment: 
-
-Filename: grain/_src/python/grain_pool.py
+Filename: grain/_src/python/samplers_test.py
 Comment: 
 
 Filename: grain/_src/python/record_test.py
 Comment: 
 
-Filename: grain/_src/python/data_sources_test.py
+Filename: grain/_src/python/multiprocessing_common.py
 Comment: 
 
-Filename: grain/_src/python/operations.py
+Filename: grain/_src/python/data_loader_test.py
 Comment: 
 
-Filename: grain/_src/python/load_test.py
+Filename: grain/_src/python/shared_memory_array_test.py
 Comment: 
 
-Filename: grain/_src/python/multiprocessing_common_test.py
+Filename: grain/_src/python/samplers.py
 Comment: 
 
-Filename: grain/_src/python/shared_memory_array.py
+Filename: grain/_src/python/options.py
 Comment: 
 
-Filename: grain/_src/python/load.py
+Filename: grain/_src/python/multiprocessing_common_test.py
 Comment: 
 
-Filename: grain/_src/python/grain_logging.py
+Filename: grain/_src/python/grain_pool_test.py
 Comment: 
 
-Filename: grain/_src/python/options.py
+Filename: grain/_src/python/operations.py
 Comment: 
 
-Filename: grain/_src/python/grain_logging_test.py
+Filename: grain/_src/python/checkpoint_handlers.py
 Comment: 
 
-Filename: grain/_src/python/data_sources.py
+Filename: grain/_src/python/record.py
 Comment: 
 
-Filename: grain/_src/python/data_loader_test.py
+Filename: grain/_src/python/grain_logging.py
 Comment: 
 
-Filename: grain/_src/python/data_loader.py
+Filename: grain/_src/python/data_sources_test.py
 Comment: 
 
-Filename: grain/_src/python/samplers_test.py
+Filename: grain/_src/python/grain_pool.py
 Comment: 
 
-Filename: grain/_src/python/checkpoint_handlers.py
+Filename: grain/_src/python/shared_memory_array.py
 Comment: 
 
-Filename: grain/_src/python/operations_test.py
+Filename: grain/_src/python/data_sources.py
 Comment: 
 
-Filename: grain/_src/python/multiprocessing_common.py
+Filename: grain/_src/python/grain_logging_test.py
 Comment: 
 
-Filename: grain/_src/python/record.py
+Filename: grain/_src/python/data_loader.py
 Comment: 
 
-Filename: grain/_src/python/shared_memory_array_test.py
+Filename: grain/_src/python/operations_test.py
 Comment: 
 
-Filename: grain/_src/python/experimental/example_packing/
+Filename: grain/_src/python/load.py
 Comment: 
 
-Filename: grain/_src/python/experimental/continual_sequence_sampler/
+Filename: grain/_src/python/load_test.py
 Comment: 
 
 Filename: grain/_src/python/experimental/index_shuffle/
 Comment: 
 
-Filename: grain/_src/python/experimental/example_packing/packing_test.py
-Comment: 
-
-Filename: grain/_src/python/experimental/example_packing/packing.py
-Comment: 
-
-Filename: grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler_test.py
+Filename: grain/_src/python/experimental/example_packing/
 Comment: 
 
-Filename: grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler.py
+Filename: grain/_src/python/experimental/continual_sequence_sampler/
 Comment: 
 
 Filename: grain/_src/python/experimental/index_shuffle/python/
 Comment: 
 
 Filename: grain/_src/python/experimental/index_shuffle/libindex_shuffle.so
 Comment: 
 
 Filename: grain/_src/python/experimental/index_shuffle/python/index_shuffle_module.so
 Comment: 
 
-Filename: grain/_src/python/experimental/index_shuffle/python/index_shuffle_python_test.py
+Filename: grain/_src/python/experimental/index_shuffle/python/index_shuffle_python.py
 Comment: 
 
 Filename: grain/_src/python/experimental/index_shuffle/python/index_shuffle_test.py
 Comment: 
 
-Filename: grain/_src/python/experimental/index_shuffle/python/index_shuffle_python.py
+Filename: grain/_src/python/experimental/index_shuffle/python/index_shuffle_python_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/
+Filename: grain/_src/python/experimental/example_packing/packing_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/grain_pool_v2_test.py
+Filename: grain/_src/python/experimental/example_packing/packing.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/data_sources_test.py
+Filename: grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/grain_pool_v2.py
+Filename: grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/data_sources.py
+Filename: grain/_src/python/lazy_dataset/transformations/
 Comment: 
 
 Filename: grain/_src/python/lazy_dataset/lazy_dataset_test.py
 Comment: 
 
 Filename: grain/_src/python/lazy_dataset/lazy_dataset.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/ragged_batch.py
+Filename: grain/_src/python/lazy_dataset/data_loader_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/filter.py
+Filename: grain/_src/python/lazy_dataset/data_sources_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/packing_test.py
+Filename: grain/_src/python/lazy_dataset/data_sources.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/repeat.py
+Filename: grain/_src/python/lazy_dataset/data_loader.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/repeat_test.py
+Filename: grain/_src/python/lazy_dataset/transformations/slice.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/mix.py
+Filename: grain/_src/python/lazy_dataset/transformations/flatmap.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/packing.py
+Filename: grain/_src/python/lazy_dataset/transformations/repeat_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/batch_test.py
+Filename: grain/_src/python/lazy_dataset/transformations/map.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/slice_test.py
+Filename: grain/_src/python/lazy_dataset/transformations/shuffle_test.py
+Comment: 
+
+Filename: grain/_src/python/lazy_dataset/transformations/repeat.py
 Comment: 
 
 Filename: grain/_src/python/lazy_dataset/transformations/shuffle.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/flatmap.py
+Filename: grain/_src/python/lazy_dataset/transformations/ragged_batch_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/shuffle_test.py
+Filename: grain/_src/python/lazy_dataset/transformations/batch_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/slice.py
+Filename: grain/_src/python/lazy_dataset/transformations/mix.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/mix_test.py
+Filename: grain/_src/python/lazy_dataset/transformations/packing_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/ragged_batch_test.py
+Filename: grain/_src/python/lazy_dataset/transformations/ragged_batch.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/filter_test.py
+Filename: grain/_src/python/lazy_dataset/transformations/filter.py
 Comment: 
 
 Filename: grain/_src/python/lazy_dataset/transformations/map_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/batch.py
+Filename: grain/_src/python/lazy_dataset/transformations/filter_test.py
 Comment: 
 
 Filename: grain/_src/python/lazy_dataset/transformations/flatmap_test.py
 Comment: 
 
-Filename: grain/_src/python/lazy_dataset/transformations/map.py
-Comment: 
-
-Filename: grain_nightly-0.0.6.dist-info/RECORD
-Comment: 
-
-Filename: grain_nightly-0.0.6.dist-info/METADATA
+Filename: grain/_src/python/lazy_dataset/transformations/batch.py
 Comment: 
 
-Filename: grain_nightly-0.0.6.dist-info/WHEEL
+Filename: grain/_src/python/lazy_dataset/transformations/packing.py
 Comment: 
 
-Filename: grain_nightly-0.0.6.dist-info/LICENSE
+Filename: grain/_src/python/lazy_dataset/transformations/mix_test.py
 Comment: 
 
-Filename: grain_nightly-0.0.6.dist-info/top_level.txt
+Filename: grain/_src/python/lazy_dataset/transformations/slice_test.py
 Comment: 
 
 Zip file comment:
```

## grain/python_experimental.py

```diff
@@ -10,14 +10,15 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 """Experimental PyGrain APIs."""
 
 # pylint: disable=g-importing-member
+# pylint: disable=g-bad-import-order
 # pylint: disable=g-multiple-import
 # pylint: disable=unused-import
 # pylint: disable=wildcard-import
 
 from . import python_lazy_dataset as lazy_dataset
 from ._src.core.transforms import (
     FlatMapTransform,
```

## grain/python.py

```diff
@@ -17,14 +17,15 @@
 # pylint: disable=g-multiple-import
 # pylint: disable=unused-import
 # pylint: disable=wildcard-import
 
 from . import python_experimental as experimental
 
 from ._src.core.config import config
+from ._src.core.constants import DATASET_INDEX, EPOCH, INDEX, META_FEATURES, RECORD, RECORD_KEY, SEED
 from ._src.core.sharding import NoSharding, ShardByJaxProcess, ShardOptions
 from ._src.core.transforms import (
     BatchTransform as Batch,
     FilterTransform,
     MapTransform,
     RandomMapTransform,
     Transformations,
```

## grain/python_lazy_dataset.py

```diff
@@ -14,19 +14,19 @@
 """Experimental PyGrain APIs."""
 
 # pylint: disable=g-importing-member
 # pylint: disable=g-multiple-import
 # pylint: disable=unused-import
 # pylint: disable=wildcard-import
 
+from ._src.python.lazy_dataset.data_loader import DataLoader
 from ._src.python.lazy_dataset.data_sources import (
     SourceLazyMapDataset,
     log_lineage_for_sources,
 )
-from ._src.python.lazy_dataset.grain_pool_v2 import GrainPool
 from ._src.python.lazy_dataset.lazy_dataset import (
     LazyMapDataset,
     LazyIterDataset,
     LazyDatasetIterator,
     RangeLazyMapDataset,
 )
 from ._src.python.lazy_dataset.transformations.batch import (
@@ -40,14 +40,15 @@
 from ._src.python.lazy_dataset.transformations.flatmap import FlatMapLazyMapDataset
 from ._src.python.lazy_dataset.transformations.map import (
     MapLazyMapDataset,
     MapLazyIterDataset,
     RngPool,
 )
 from ._src.python.lazy_dataset.transformations.mix import (
+    ConcatenateLazyMapDataset,
     DatasetSelectionMap,
     MixedLazyMapDataset,
     MixedLazyIterDataset,
 )
 from ._src.python.lazy_dataset.transformations.packing import SingleBinPackLazyIterDataset
 from ._src.python.lazy_dataset.transformations.ragged_batch import RaggedBatchLazyMapDataset
 from ._src.python.lazy_dataset.transformations.repeat import RepeatLazyMapDataset
```

## grain/_src/core/config.py

```diff
@@ -69,21 +69,32 @@
         "Deprecated. If True will split up the first batch lookup into smaller"
         " chunks. This can help to provide initial elements fast while allowing"
         " when using a large tf_lookup_batch_size (which is usually better for"
         " throughput)."
     ),
 )
 
+_OPTIMIZED_SEQUENTIAL_READ = flags.DEFINE_bool(
+    "grain_tf_optimized_sequential_read",
+    False,
+    (
+        "Enables optimized reads in TfMixtureDataLoader in case when sampler"
+        " produces sequential indices and the input sources support it."
+        " Experimental -- do not use."
+    ),
+)
+
 _GRAIN_FLAGS = (
     _INTERLEAVED_SHUFFLE,
     _INTERLEAVED_SHUFFLE_BLOCK_SIZE,
     _INTERLEAVED_SHUFFLE_NUM_BLOCKS_PER_PARTITION,
     _LOOKUP_BATCH_SIZE,
     _LOOKUP_NUM_PARALLEL_CALLS,
     _LOOKUP_FAST_WARMUP,
+    _OPTIMIZED_SEQUENTIAL_READ,
 )
 
 
 class Config:
   """Class for holding current Grain configuration."""
 
   # Loosen the static type checking requirements.
```

## grain/_src/core/sharding.py

```diff
@@ -11,15 +11,14 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 """Classes for handling sharding of data sources arcoss machines/VMs."""
 import dataclasses
 
 from absl import logging
-import jax
 
 
 @dataclasses.dataclass(frozen=True)
 class ShardOptions:
   """Dataclass to hold options for sharding a data source.
 
   Attributes:
@@ -55,14 +54,17 @@
     super().__init__(shard_index=0, shard_count=1, drop_remainder=False)
 
 
 class ShardByJaxProcess(ShardOptions):
   """Shards the data across JAX processes."""
 
   def __init__(self, drop_remainder: bool = False):
+    # pylint: disable=g-import-not-at-top
+    import jax  # pytype: disable=import-error
+    # pylint: enable=g-import-not-at-top
     super().__init__(
         shard_index=jax.process_index(),
         shard_count=jax.process_count(),
         drop_remainder=drop_remainder,
     )
```

## grain/_src/python/experimental/example_packing/packing.py

```diff
@@ -38,27 +38,27 @@
     # Define the main buffers we will pack the data into.
     def make_packed_buffer(length: int, input_arr: np.ndarray):
       return np.zeros(
           shape=(batch_size, length, *input_arr.shape[1:]),  # (B, T, ...)
           dtype=input_arr.dtype,
       )
 
-    self._batch = jax.tree_map(
+    self._batch = jax.tree.map(
         make_packed_buffer, length_struct, element_for_shapes
     )
 
     def make_packed_aux_info(length: int):
       return np.zeros(shape=(batch_size, length), dtype=np.int32)
 
-    self._segmentations = jax.tree_map(make_packed_aux_info, length_struct)
-    self._positions = jax.tree_map(make_packed_aux_info, length_struct)
+    self._segmentations = jax.tree.map(make_packed_aux_info, length_struct)
+    self._positions = jax.tree.map(make_packed_aux_info, length_struct)
 
     # Tracks the next empty position to insert an example for each row
     # in the batch, for each feature in features_to_pack.
-    self._first_free_cell_per_row = jax.tree_map(
+    self._first_free_cell_per_row = jax.tree.map(
         lambda _: np.zeros(batch_size, dtype=np.int32), length_struct
     )
 
     # Tracks the number of examples already packed into row of the batch. Used
     # to fill the segmentation values for each feature.
     self._num_examples_per_row = [0 for _ in range(batch_size)]
 
@@ -71,33 +71,33 @@
     return record.Record(
         metadata=cast(record.RecordMetadata, self._last_record_metadata),
         data=(self._batch, self._segmentations, self._positions),
     )
 
   def _can_add_at_row(self, element: jt.PyTree[np.ndarray]) -> int:
     """Returns the index of the first row which fits element, or -1 if none."""
-    element_feature_lengths = jax.tree_map(len, element)
+    element_feature_lengths = jax.tree.map(len, element)
 
     # Check no feature exceeds max length
-    length_exceeded = jax.tree_map(
+    length_exceeded = jax.tree.map(
         lambda feature_length, max_length: feature_length > max_length,
         element_feature_lengths,
         self._length_struct,
     )
     if any(tree.flatten(length_exceeded)):
       raise ValueError(
           "Inputs to PackAndBatchOperation must be truncated to max length."
       )
 
     # For each row, check whether the total length after adding the current
     # element would exceed max feature lengths.
     def _feature_will_fit(feature_length, first_free_cell, max_length):
       return feature_length + first_free_cell <= max_length
 
-    is_row_free_struct = jax.tree_map(
+    is_row_free_struct = jax.tree.map(
         _feature_will_fit,
         element_feature_lengths,
         self._first_free_cell_per_row,
         self._length_struct,
     )
 
     ## Pick first row (if exists) where element can be added.
```

## grain/_src/python/lazy_dataset/transformations/mix.py

```diff
@@ -10,14 +10,15 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 """Mixing transformation for LazyDataset."""
 
 import abc
+import bisect
 import dataclasses
 import functools
 import sys
 from typing import Any, Optional, Sequence, Tuple, TypeVar, Union
 
 from grain._src.core import exceptions
 from grain._src.python.lazy_dataset import lazy_dataset
@@ -291,7 +292,70 @@
   # the same.
   for dataset_index in range(len(proportions)):
     if old_counts[dataset_index] != new_counts[dataset_index]:
       return dataset_index, new_counts[dataset_index] - 1
   raise exceptions.PyGrainInternalError(
       "PyGrain internal error: please file a bug with the Grain team."
   )
+
+
+@dataclasses.dataclass
+class _ConcatSelectionMap(DatasetSelectionMap):
+  """Concatenated datasets selection map.
+
+  Selection map that concatenates the elements from a sequence of finite parent
+  datasets. Elements from a dataset with index i will appear after the elements
+  of all previous datasets with indices 0, 1, ..., i-1 and before the elements
+  of datasets with indices i+1, i+2, ...
+  """
+
+  def __init__(
+      self,
+      parents: Sequence[lazy_dataset.LazyMapDataset],
+  ):
+    dataset_sizes = [len(parent) for parent in parents]
+    for i, dataset_size in enumerate(dataset_sizes):
+      if dataset_size >= sys.maxsize:
+        raise ValueError(
+            f"Cannot concatenate infinite datasets. {parents[i]} is infinite."
+        )
+    cumulative_sizes = [0] * (len(parents) + 1)
+    for i in range(len(parents)):
+      cumulative_sizes[i + 1] = cumulative_sizes[i] + dataset_sizes[i]
+    self._cumulative_dataset_sizes = cumulative_sizes
+
+  def __len__(self) -> int:
+    return self._cumulative_dataset_sizes[-1]
+
+  def __getitem__(self, index: int) -> tuple[int, int]:
+    dataset_index = (
+        bisect.bisect_right(self._cumulative_dataset_sizes, index) - 1
+    )
+    return dataset_index, index - self._cumulative_dataset_sizes[dataset_index]
+
+
+@dataclasses.dataclass
+class ConcatenateLazyMapDataset(lazy_dataset.LazyMapDataset[T]):
+  """LazyDataset for concatenating the elements from a sequence of datasets."""
+
+  def __init__(
+      self,
+      parents: Sequence[lazy_dataset.LazyMapDataset[T]],
+  ):
+    """Initializes the concatenated dataset.
+
+    Args:
+      parents: Component datasets to draw from. We will draw elements in order
+        of their appearance in `parents`.
+    """
+    super().__init__(parents)
+    self._selection_map = _ConcatSelectionMap(parents)
+    self._length = len(self._selection_map)
+
+  def __len__(self) -> int:
+    return self._length
+
+  def __getitem__(self, index):
+    if isinstance(index, slice):
+      return self.slice(index)
+    dataset, dataset_index = self._selection_map[index]
+    return self._parents[dataset][dataset_index]
```

## grain/_src/python/lazy_dataset/transformations/mix_test.py

```diff
@@ -16,14 +16,15 @@
 import sys
 from typing import Callable, Tuple
 
 from absl.testing import absltest
 from grain._src.python.lazy_dataset import lazy_dataset
 from grain._src.python.lazy_dataset.transformations import mix
 from grain._src.python.lazy_dataset.transformations import repeat  # pylint: disable=unused-import
+from grain._src.python.lazy_dataset.transformations import slice as slice_transform  # pylint: disable=unused-import
 import numpy as np
 
 
 class ExplicitSelectionMap(mix.DatasetSelectionMap):
 
   def __init__(
       self, length: int, selection_map: Callable[[int], Tuple[int, int]]
@@ -467,9 +468,56 @@
       ds_iter.set_state(checkpoints[starting_step])  # pytype: disable=attribute-error
       for i in range(starting_step, max_steps):
         np.testing.assert_array_equal(
             next(ds_iter), values_without_interruption[i]
         )
 
 
+class ConcatenateLazyMapTest(absltest.TestCase):
+
+  def test_concat_selection_map(self):
+    evens = lazy_dataset.RangeLazyMapDataset(0, 4, 2)
+    odds = lazy_dataset.RangeLazyMapDataset(1, 6, 2)
+    consecutive = lazy_dataset.RangeLazyMapDataset(7, 9)
+    selection_map = mix._ConcatSelectionMap([evens, odds, consecutive])
+    self.assertLen(selection_map, len(evens) + len(odds) + len(consecutive))
+
+    actual_indices = [selection_map[i] for i in range(len(selection_map))]
+    expected_indices = [(0, 0), (0, 1), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1)]
+    self.assertListEqual(actual_indices, expected_indices)
+
+  def test_concatenate_finite_datasets(self):
+    evens = lazy_dataset.RangeLazyMapDataset(0, 10, 2)
+    odds = lazy_dataset.RangeLazyMapDataset(1, 10, 2)
+    ds = mix.ConcatenateLazyMapDataset([evens, odds])
+    self.assertLen(evens, 5)
+    self.assertLen(odds, 5)
+    self.assertLen(ds, 10)
+
+    ds_iter = ds.to_iter_dataset()
+    actual_values = list(ds_iter)
+    expected_values = [0, 2, 4, 6, 8, 1, 3, 5, 7, 9]
+    self.assertListEqual(actual_values, expected_values)
+
+  def test_slice_concatenated_finite_datasets(self):
+    evens = lazy_dataset.RangeLazyMapDataset(0, 10, 2)
+    odds = lazy_dataset.RangeLazyMapDataset(1, 10, 2)
+    ds = mix.ConcatenateLazyMapDataset([evens, odds])[4:7]
+    self.assertLen(ds, 3)
+
+    ds_iter = ds.to_iter_dataset()
+    actual_values = list(ds_iter)
+    # full=[0, 2, 4, 6, 8, 1, 3, 5, 7, 9], sliced=full[4:7]
+    expected_values = [8, 1, 3]
+    self.assertListEqual(actual_values, expected_values)
+
+  def test_cannot_concatenate_infinite_datasets(self):
+    zeros = lazy_dataset.RangeLazyMapDataset(0, 1).repeat()
+    ones = lazy_dataset.RangeLazyMapDataset(1, 2).repeat()
+    with self.assertRaisesRegex(
+        ValueError, "Cannot concatenate infinite datasets"
+    ):
+      _ = mix._ConcatSelectionMap([zeros, ones])
+
+
 if __name__ == "__main__":
   absltest.main()
```

## grain/_src/python/lazy_dataset/transformations/map_test.py

```diff
@@ -10,16 +10,17 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 """Tests for map transformation."""
 
 import dataclasses
-
 from absl.testing import absltest
+from absl.testing import parameterized
+import cloudpickle
 from grain._src.core import transforms
 from grain._src.python.lazy_dataset import lazy_dataset
 from grain._src.python.lazy_dataset.transformations import map as ldmap
 import numpy as np
 
 
 @dataclasses.dataclass(frozen=True)
@@ -54,15 +55,15 @@
 @dataclasses.dataclass(frozen=True)
 class AddIndexTransform(transforms.MapWithIndexTransform):
 
   def map_with_index(self, index: int, element: int):
     return (index, element)
 
 
-class MapLazyMapDatasetTest(absltest.TestCase):
+class MapLazyMapDatasetTest(parameterized.TestCase):
 
   def setUp(self):
     super().setUp()
     self.range_ds = lazy_dataset.RangeLazyMapDataset(0, 10)
 
   def test_map_size(self):
     map_ds_no_transform = ldmap.MapLazyMapDataset(
@@ -74,14 +75,24 @@
     map_ds_with_random_transform = ldmap.MapLazyMapDataset(
         self.range_ds, RandomMapWithTransform(), seed=0
     )
     self.assertLen(map_ds_no_transform, len(self.range_ds))
     self.assertLen(map_ds_with_transform, len(self.range_ds))
     self.assertLen(map_ds_with_random_transform, len(self.range_ds))
 
+  @parameterized.parameters(
+      MapWithNoTransform,
+      MapWithTransform,
+      RandomMapWithTransform,
+  )
+  def test_map_picklable(self, map_cls):
+    ds = ldmap.MapLazyMapDataset(self.range_ds, map_cls(), seed=0)
+    ds = cloudpickle.loads(cloudpickle.dumps(ds))
+    self.assertLen(ds, len(self.range_ds))
+
   def test_map_data_no_transform(self):
     map_ds_no_transform = ldmap.MapLazyMapDataset(
         self.range_ds, MapWithNoTransform()
     )
     expected_data = [i for i in range(10)]
     actual_data = [
         map_ds_no_transform[i] for i in range(len(map_ds_no_transform))
```

## grain/_src/python/lazy_dataset/transformations/map.py

```diff
@@ -53,14 +53,17 @@
   """RNG pool."""
 
   def __init__(self, seed: int):
     self._seed = seed
     self._generator_cache = []
     self._lock = threading.Lock()
 
+  def __reduce__(self):
+    return (RngPool, (self._seed,))
+
   def acquire_rng(self, index: int, *, op_seed: int = 0) -> np.random.Generator:
     """Acquire RNG."""
     if self._generator_cache:
       with self._lock:
         rng = self._generator_cache.pop()
     else:
       rng = np.random.Generator(np.random.Philox(self._seed))
```

## Comparing `grain_nightly-0.0.6.dist-info/RECORD` & `grain_nightly-0.0.7.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,79 +1,79 @@
+grain_nightly-0.0.7.dist-info/WHEEL,sha256=rY0Y6THYM7EImsHfF-zs67o8pQciAsMw9_YuSvftjrQ,148
+grain_nightly-0.0.7.dist-info/top_level.txt,sha256=-B-uymHFMIUZlLoXfhhon8S30_moKYnumB5yrjz2zg0,6
+grain_nightly-0.0.7.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
+grain_nightly-0.0.7.dist-info/METADATA,sha256=rw8eDc2R4kkQYkeXSsH-6S-1tGdLYhz5Aj8LDzBARNU,13899
+grain_nightly-0.0.7.dist-info/RECORD,,
+grain/python_lazy_dataset.py,sha256=c9usranWWEFlXuEEaZrNzYP6bNJ7F7yko_kUE-ltQqg,2104
 grain/core.py,sha256=fAPuAJ8UKi4qYefzQRy6DIR4wlL23I5OU5JIkCknmj0,928
-grain/python_experimental.py,sha256=My05jAhIUbMc5FcgBqtQPfTGH1tNTc_g26kMQBG8pO0,1228
-grain/python.py,sha256=_EQrei5-uxnMKQsJkew1dnU2oaTSRkUIQsTWgLz7Rvk,2120
-grain/python_lazy_dataset.py,sha256=6yzjPQW1fjRlBDAkeiuHBVFiyQ01q_MufJMAYgPqUXs,2074
-grain/_src/core/tree_test.py,sha256=-YM8my2iyoWUN1h8X2uo_4CsnZRGkVBYKFFjmmrb_i4,2391
-grain/_src/core/parallel_test.py,sha256=xxfj7NEUiKCRO3Pt_NooZLmpfAWOoQb4DuqOJVEcAGE,3156
+grain/python.py,sha256=1f458zlndm63j6FGVu4QGQClc4Sq4-Jm2Wij5zp8xgE,2222
+grain/python_experimental.py,sha256=_p0gUTXe1w4bQs8O4j5x3So-jEd6F_Uhh0ACPWuFLiI,1265
+grain/_src/core/tree.py,sha256=6orVSN8hlXPUib5qltsPzap14iXYvXTkf6pBwqw7Y5Y,1939
 grain/_src/core/tree_jax_test.py,sha256=DXKxrcoBkgfrnSJSGUXRErMicSfOo2KvFXPMuJJDVhg,1245
-grain/_src/core/config.py,sha256=AljqKmh2F0UjmbmnJNnzK47PcN2-89cwxGW6PHaVeeY,3618
-grain/_src/core/transforms.py,sha256=uTqErIL2TroDfifYwG2E7IVTydUP4HQRnKrEcaztVms,3767
 grain/_src/core/usage_logging.py,sha256=5Mtt2scTWmjYK0NrDOHswmkdz95sQuDte861udqVV3Q,685
-grain/_src/core/tree.py,sha256=6orVSN8hlXPUib5qltsPzap14iXYvXTkf6pBwqw7Y5Y,1939
+grain/_src/core/config.py,sha256=FvUdtoW_NbI4DHrU2tAWaHem3045nqU5ie5wN4MmWu4,3957
+grain/_src/core/transforms.py,sha256=uTqErIL2TroDfifYwG2E7IVTydUP4HQRnKrEcaztVms,3767
+grain/_src/core/grain_random.py,sha256=MvPSXViJmluiQDazpZey38F8l1-S1QlWWS0cquf7s1w,5380
+grain/_src/core/tree_test.py,sha256=-YM8my2iyoWUN1h8X2uo_4CsnZRGkVBYKFFjmmrb_i4,2391
 grain/_src/core/sharding_test.py,sha256=r8dhEfs3zmgtm-e7X6-CBaPrd9JacGzuyAR_ELhpAiY,1277
+grain/_src/core/parallel_test.py,sha256=xxfj7NEUiKCRO3Pt_NooZLmpfAWOoQb4DuqOJVEcAGE,3156
 grain/_src/core/exceptions.py,sha256=yDRm7cRAKVkpB9FF-QLeV2-1iSqIW4IjMk89BMepMVE,109
-grain/_src/core/parallel.py,sha256=h15IE2MCmDtKjkhRi8uSVPC__M6I7qOToZznDiF5EGE,2310
+grain/_src/core/sharding.py,sha256=Wv8UnY1JA1cf_cskRdbBLmeJxC5X-c_r8sCtfGfYKts,3680
 grain/_src/core/constants.py,sha256=BJMbv2ubBQEehAELzHIMMneFjSuYByrSwyGOpF2cJY0,1633
-grain/_src/core/sharding.py,sha256=M7qfHgBEa_CRCz0GxZh5gCNK9z11wXI357ZO5dVxKhA,3561
-grain/_src/core/grain_random.py,sha256=MvPSXViJmluiQDazpZey38F8l1-S1QlWWS0cquf7s1w,5380
+grain/_src/core/parallel.py,sha256=h15IE2MCmDtKjkhRi8uSVPC__M6I7qOToZznDiF5EGE,2310
+grain/_src/python/samplers_test.py,sha256=4uS37AnzMAOHtwHbSohSVXpq8hm2zSni-L36UsSV6nU,23219
+grain/_src/python/record_test.py,sha256=VzC8IPje-ZjM6CbWUJ1NbAiXBCpeWbpoVSITKTAj4Hc,1288
+grain/_src/python/multiprocessing_common.py,sha256=B51RWZPX6BvqldoUmjI66fLyEheb2u6zgTBIa6iqnhY,2434
+grain/_src/python/data_loader_test.py,sha256=nwLNLBV8sqH_nzYgeANLbiz01_8_vilo3X3V4LHqYDc,21011
+grain/_src/python/shared_memory_array_test.py,sha256=HzqiOu9K95DxH6lhtZM_hhcaNdsHfFPmCQDS1WArTPA,3007
 grain/_src/python/samplers.py,sha256=57THi7_V2CiR1UbOgMi8qkYdmQcTi43pKjoqh4BmqEE,5514
+grain/_src/python/options.py,sha256=rJCmvfxH6FsXW0ZHCQr4c2OUjbWQBRFSp0pqTRXaXYI,2442
+grain/_src/python/multiprocessing_common_test.py,sha256=mnYNHUpjKqGuAiRWipuUANPGfA9FJ626on57ROuqsAU,3580
 grain/_src/python/grain_pool_test.py,sha256=NNgqGOYiYg-f_uKhh0naCHxAFfQwtYTTLUXs3Qh_RoU,11244
-grain/_src/python/grain_pool.py,sha256=L277-PZchl-DGB3QBmppqxpMoJFE4TOWEYcRsLEKgP0,23300
-grain/_src/python/record_test.py,sha256=VzC8IPje-ZjM6CbWUJ1NbAiXBCpeWbpoVSITKTAj4Hc,1288
-grain/_src/python/data_sources_test.py,sha256=xxQ0M3QgOi5F0yz994Emggucx6nVEhzz0F360Mm75zA,5010
 grain/_src/python/operations.py,sha256=RS3f5gAzZt9-IDL5uYE3ibVv630_7GqxlVLJ6jl0kTI,7432
-grain/_src/python/load_test.py,sha256=e7XVjqL7tWWiAUUj21Ew2ynFjLPO8omnVIpAMpbEQOI,2049
-grain/_src/python/multiprocessing_common_test.py,sha256=mnYNHUpjKqGuAiRWipuUANPGfA9FJ626on57ROuqsAU,3580
-grain/_src/python/shared_memory_array.py,sha256=G-LJMwgAPuCWrbXaeGe_cE1FsEHGv4rGZXEaXGnVVA0,5139
-grain/_src/python/load.py,sha256=SApgBPmq8d8irYsLiVN0cNyH5G0auNUSimz9xrrRRgU,2320
+grain/_src/python/checkpoint_handlers.py,sha256=W8nUovAYEBfqFV1TwYd1l87P1j80Fj-mjZOtZ86M0v0,3174
+grain/_src/python/record.py,sha256=2WFHMVGKktC6cmEZ7Gb4yL-xrysSep3B-lPDfnlNDec,1741
 grain/_src/python/grain_logging.py,sha256=R5CI-eHpkVfR6DiZ04_afx7JDCUfFAEj0gm1HZ3310o,552
-grain/_src/python/options.py,sha256=rJCmvfxH6FsXW0ZHCQr4c2OUjbWQBRFSp0pqTRXaXYI,2442
-grain/_src/python/grain_logging_test.py,sha256=RDJ7O83As-Jvshz6gCVnfJnA4qYjeHJfAgtD0JTrM9A,1746
+grain/_src/python/data_sources_test.py,sha256=xxQ0M3QgOi5F0yz994Emggucx6nVEhzz0F360Mm75zA,5010
+grain/_src/python/grain_pool.py,sha256=L277-PZchl-DGB3QBmppqxpMoJFE4TOWEYcRsLEKgP0,23300
+grain/_src/python/shared_memory_array.py,sha256=G-LJMwgAPuCWrbXaeGe_cE1FsEHGv4rGZXEaXGnVVA0,5139
 grain/_src/python/data_sources.py,sha256=PptIGK50lo-cTOxFbtfPauwsm3ZSCa9pcdSBs5cbScM,5309
-grain/_src/python/data_loader_test.py,sha256=nwLNLBV8sqH_nzYgeANLbiz01_8_vilo3X3V4LHqYDc,21011
+grain/_src/python/grain_logging_test.py,sha256=RDJ7O83As-Jvshz6gCVnfJnA4qYjeHJfAgtD0JTrM9A,1746
 grain/_src/python/data_loader.py,sha256=o-XGTMVT9mIpLcK2kX1UFyNDBPIBaZbMeKYvhoJuP5c,19035
-grain/_src/python/samplers_test.py,sha256=4uS37AnzMAOHtwHbSohSVXpq8hm2zSni-L36UsSV6nU,23219
-grain/_src/python/checkpoint_handlers.py,sha256=W8nUovAYEBfqFV1TwYd1l87P1j80Fj-mjZOtZ86M0v0,3174
 grain/_src/python/operations_test.py,sha256=EaDkpIxafzAY7oIH1LfuuzVbyvvCC_ptkhdIeAfvSHQ,13128
-grain/_src/python/multiprocessing_common.py,sha256=B51RWZPX6BvqldoUmjI66fLyEheb2u6zgTBIa6iqnhY,2434
-grain/_src/python/record.py,sha256=2WFHMVGKktC6cmEZ7Gb4yL-xrysSep3B-lPDfnlNDec,1741
-grain/_src/python/shared_memory_array_test.py,sha256=HzqiOu9K95DxH6lhtZM_hhcaNdsHfFPmCQDS1WArTPA,3007
-grain/_src/python/experimental/example_packing/packing_test.py,sha256=7U9A3Fg0CLecyHDXLu3h_wLh1hW0R7xBME6ZnsxxE00,13841
-grain/_src/python/experimental/example_packing/packing.py,sha256=xWL8or5423xCl1bMjZxorbXPu5G_Fw-sTfLjKI-DX9g,8133
-grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler_test.py,sha256=ZFscc4j_k8qJ3qWyR8NqGrMy1ZePMC6YDkXjCnWn83M,17255
-grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler.py,sha256=bOReiqHEVANnUALizhh0iiykzAvhywVCPu0JQLvgJKQ,16400
+grain/_src/python/load.py,sha256=SApgBPmq8d8irYsLiVN0cNyH5G0auNUSimz9xrrRRgU,2320
+grain/_src/python/load_test.py,sha256=e7XVjqL7tWWiAUUj21Ew2ynFjLPO8omnVIpAMpbEQOI,2049
 grain/_src/python/experimental/index_shuffle/libindex_shuffle.so,sha256=2lETuhvJ1NpeBAQ_voTUgInSGlx6Mpa-XJ34em_gWVc,191504
 grain/_src/python/experimental/index_shuffle/python/index_shuffle_module.so,sha256=EJuBx9Y8AksntL2HqgR5i42_hr4hosdC_l6RCBUqRrg,871568
-grain/_src/python/experimental/index_shuffle/python/index_shuffle_python_test.py,sha256=_63FcUq39RfB7TnjD22CTomvCqC0nZf38HV-xw1PnJY,1621
-grain/_src/python/experimental/index_shuffle/python/index_shuffle_test.py,sha256=w6868rerNvwc9t1dJ3iGfzWVpDdxLE22BW3J-OXbvwc,1586
 grain/_src/python/experimental/index_shuffle/python/index_shuffle_python.py,sha256=IrO_vFuF8W4LemkfbZcNbQO2_IVJcLR_2g4kfjl_VrA,2490
-grain/_src/python/lazy_dataset/grain_pool_v2_test.py,sha256=xyxrCvhRQBcZ5nPYTx7drEc1N9WMfWNaUbe5hVYR1Q0,7873
-grain/_src/python/lazy_dataset/data_sources_test.py,sha256=CgOLdr6bLunOQkVZNybhEpCLq56Pbh4a1fOuJp30Ydo,2742
-grain/_src/python/lazy_dataset/grain_pool_v2.py,sha256=7dyO9L86iC4nAuhh-RsG92uz8tEwQzFtsBC18k26YvY,11912
-grain/_src/python/lazy_dataset/data_sources.py,sha256=rQrWFy-7bIhCYDem3aXZrN-uz1-jiP99QRsrHVWHwHQ,1603
+grain/_src/python/experimental/index_shuffle/python/index_shuffle_test.py,sha256=w6868rerNvwc9t1dJ3iGfzWVpDdxLE22BW3J-OXbvwc,1586
+grain/_src/python/experimental/index_shuffle/python/index_shuffle_python_test.py,sha256=_63FcUq39RfB7TnjD22CTomvCqC0nZf38HV-xw1PnJY,1621
+grain/_src/python/experimental/example_packing/packing_test.py,sha256=7U9A3Fg0CLecyHDXLu3h_wLh1hW0R7xBME6ZnsxxE00,13841
+grain/_src/python/experimental/example_packing/packing.py,sha256=WlU8jVl-MtNP0YVSe2sKQ62qU8F37r-TQHSI64rt1aM,8133
+grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler.py,sha256=bOReiqHEVANnUALizhh0iiykzAvhywVCPu0JQLvgJKQ,16400
+grain/_src/python/experimental/continual_sequence_sampler/continual_sequence_sampler_test.py,sha256=ZFscc4j_k8qJ3qWyR8NqGrMy1ZePMC6YDkXjCnWn83M,17255
 grain/_src/python/lazy_dataset/lazy_dataset_test.py,sha256=u0p9_LR_uuVwWLZSSsg3Cah0SDAK1YlZX32kAFgnJ3Q,9763
 grain/_src/python/lazy_dataset/lazy_dataset.py,sha256=QZN00DvidHrbN5t4g6ntqJWNg2J8gUbi5VjH_16aZGM,18734
-grain/_src/python/lazy_dataset/transformations/ragged_batch.py,sha256=uPSUTRo0X_BDISNOg6wgLYAleGFBPxhL_sflpY5hHKI,1565
-grain/_src/python/lazy_dataset/transformations/filter.py,sha256=EAouVqfmT_JzKu9oUqoLJbSJxPGbgPVmahPFNQfZnok,3294
-grain/_src/python/lazy_dataset/transformations/packing_test.py,sha256=lwZvccYZ1wSiQJZvqUpHEknBuoQwYT7VdMdn1rGATKE,12276
-grain/_src/python/lazy_dataset/transformations/repeat.py,sha256=NRN6qcI_b5qfzEV76S8uZPFlXVwCFFPPqAVX-QAY_rA,1701
-grain/_src/python/lazy_dataset/transformations/repeat_test.py,sha256=rkB52Z1GorIfHFfzhcJISSZc7ZJD9lUYRkZLB5_wkjk,1420
-grain/_src/python/lazy_dataset/transformations/mix.py,sha256=qDzNJavS2WIPcOoXlVryGepQndzg98tHeAMVseWe45k,9660
-grain/_src/python/lazy_dataset/transformations/packing.py,sha256=J3v4cKVb7Kt-cz3FBIJGvOwjRUK9MTVZak-_p61nIbA,10244
-grain/_src/python/lazy_dataset/transformations/batch_test.py,sha256=3IWODzOa6NOqGJOo_e8ww2RdFSi_6orGwCCv2WFlnGU,3003
-grain/_src/python/lazy_dataset/transformations/slice_test.py,sha256=HVImAL0RxfIAXdy_DmHtajFP_VIpHUmqIXNeFawD9F0,2618
-grain/_src/python/lazy_dataset/transformations/shuffle.py,sha256=jvhOeJGk1tglQIFyJbjkPhHdQV25xC6UH5efKHtyazU,2963
+grain/_src/python/lazy_dataset/data_loader_test.py,sha256=f42edB6lgdkPmwn0Wp53sfgoViR2PgZgVQvACWVvfyw,4310
+grain/_src/python/lazy_dataset/data_sources_test.py,sha256=CgOLdr6bLunOQkVZNybhEpCLq56Pbh4a1fOuJp30Ydo,2742
+grain/_src/python/lazy_dataset/data_sources.py,sha256=rQrWFy-7bIhCYDem3aXZrN-uz1-jiP99QRsrHVWHwHQ,1603
+grain/_src/python/lazy_dataset/data_loader.py,sha256=CyswbMdzB312uoErR7jAkPavTXQlKQgKAfMN1ybm-aU,2665
+grain/_src/python/lazy_dataset/transformations/slice.py,sha256=jTJ1e3vwElWG4BaWKHBR4TRjfSml00Q8VeXrbRpW18U,1591
 grain/_src/python/lazy_dataset/transformations/flatmap.py,sha256=vqwgina6O3SPGVPP-DdzGigUJruTtY1z9PYZ1m2hKXY,2018
+grain/_src/python/lazy_dataset/transformations/repeat_test.py,sha256=rkB52Z1GorIfHFfzhcJISSZc7ZJD9lUYRkZLB5_wkjk,1420
+grain/_src/python/lazy_dataset/transformations/map.py,sha256=DnNTNIJJMg6ouZvSJ5LBC_aNsorx3seyt-twEuoieNg,7300
 grain/_src/python/lazy_dataset/transformations/shuffle_test.py,sha256=3IhIfzWg1lJecnhFP2LTAfZ01defQ5ylEKvTgkMlKWM,3644
-grain/_src/python/lazy_dataset/transformations/slice.py,sha256=jTJ1e3vwElWG4BaWKHBR4TRjfSml00Q8VeXrbRpW18U,1591
-grain/_src/python/lazy_dataset/transformations/mix_test.py,sha256=5qnl_wEgbwcVFc85OOgWTeGmUNlfWV43Fc-pVOxTmUM,15586
+grain/_src/python/lazy_dataset/transformations/repeat.py,sha256=NRN6qcI_b5qfzEV76S8uZPFlXVwCFFPPqAVX-QAY_rA,1701
+grain/_src/python/lazy_dataset/transformations/shuffle.py,sha256=jvhOeJGk1tglQIFyJbjkPhHdQV25xC6UH5efKHtyazU,2963
 grain/_src/python/lazy_dataset/transformations/ragged_batch_test.py,sha256=aX7ln3aWTronk9H46DrVnw3x_DwQ9H-K0lQ_TE7hSlk,3996
+grain/_src/python/lazy_dataset/transformations/batch_test.py,sha256=3IWODzOa6NOqGJOo_e8ww2RdFSi_6orGwCCv2WFlnGU,3003
+grain/_src/python/lazy_dataset/transformations/mix.py,sha256=76yjXE5-YSa8csMpdn9RtW7OTD2nNwtumjn2Rqhr48Y,11774
+grain/_src/python/lazy_dataset/transformations/packing_test.py,sha256=lwZvccYZ1wSiQJZvqUpHEknBuoQwYT7VdMdn1rGATKE,12276
+grain/_src/python/lazy_dataset/transformations/ragged_batch.py,sha256=uPSUTRo0X_BDISNOg6wgLYAleGFBPxhL_sflpY5hHKI,1565
+grain/_src/python/lazy_dataset/transformations/filter.py,sha256=EAouVqfmT_JzKu9oUqoLJbSJxPGbgPVmahPFNQfZnok,3294
+grain/_src/python/lazy_dataset/transformations/map_test.py,sha256=-T1QIvdXmZwoLTnc0fazVs860YPryNec0foTPGY4Nes,6743
 grain/_src/python/lazy_dataset/transformations/filter_test.py,sha256=cBMLRuI2SWInGVOa2gMv6GfzWhxeB4gAlHKRdGmWE7s,4127
-grain/_src/python/lazy_dataset/transformations/map_test.py,sha256=JpB8xdLC2FagZKTt1n0WW1DUaV8j8ncclwDpjrJrtBc,6366
-grain/_src/python/lazy_dataset/transformations/batch.py,sha256=2jPykUo1W3rV-F0Q6aR742GM0rODwshsW-KCR1hrsHE,3996
 grain/_src/python/lazy_dataset/transformations/flatmap_test.py,sha256=P8_guxog-RJyayxgFBSBN-il0HDuZ60hxYdnPmM10hU,4180
-grain/_src/python/lazy_dataset/transformations/map.py,sha256=aA7_vvPPnTuRvknCGKVrS45gsDiqAdK-G1LDoQQxw-U,7239
-grain_nightly-0.0.6.dist-info/RECORD,,
-grain_nightly-0.0.6.dist-info/METADATA,sha256=A6OqSd3IoGPG2c29BHHsFYF-5z4mtf7JED6zZ0GemhE,13899
-grain_nightly-0.0.6.dist-info/WHEEL,sha256=uQ9JcPdAMEhlCRnfrhg6ydnbrPot9NaB8igB3QVnPX0,148
-grain_nightly-0.0.6.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
-grain_nightly-0.0.6.dist-info/top_level.txt,sha256=-B-uymHFMIUZlLoXfhhon8S30_moKYnumB5yrjz2zg0,6
+grain/_src/python/lazy_dataset/transformations/batch.py,sha256=2jPykUo1W3rV-F0Q6aR742GM0rODwshsW-KCR1hrsHE,3996
+grain/_src/python/lazy_dataset/transformations/packing.py,sha256=J3v4cKVb7Kt-cz3FBIJGvOwjRUK9MTVZak-_p61nIbA,10244
+grain/_src/python/lazy_dataset/transformations/mix_test.py,sha256=9XgUyNTW--UlfdZ2WO-zhmc303NPl0ljBcu0DeYJfdA,17586
+grain/_src/python/lazy_dataset/transformations/slice_test.py,sha256=HVImAL0RxfIAXdy_DmHtajFP_VIpHUmqIXNeFawD9F0,2618
```

## Comparing `grain_nightly-0.0.6.dist-info/METADATA` & `grain_nightly-0.0.7.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: grain-nightly
-Version: 0.0.6
+Version: 0.0.7
 Summary: Grain: A library for loading and transforming data for neural network training.
 Author-email: Grain team <grain-dev@google.com>
 License: Apache License
                                    Version 2.0, January 2004
                                 http://www.apache.org/licenses/
         
            TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
```

## Comparing `grain_nightly-0.0.6.dist-info/LICENSE` & `grain_nightly-0.0.7.dist-info/LICENSE`

 * *Files identical despite different names*

